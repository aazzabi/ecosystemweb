{% extends './Default/da_page_livreur.html.twig' %}
{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{{ asset('assets/css/style.css') }}">
    <link rel="stylesheet"  href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css">
{% endblock %}

{% block javascripts %}
    <script>
        $(document).ready(function () {
            var users = $('#cmd').DataTable({
                "paging": true,
                "stateSave": true,
                "language": {
                    "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/French.json",
                }
            });

        });
    </script>
{% endblock %}

{% block body %}
    {% if livraison|length >0 %}
        <h1> Liste de vos livraisons :</h1>

        <p></p>
        <div class="tab-content" >
            <div class="tab-pane active" id="users" aria-expanded="true">
                <table id="cmd" class="table table-striped table-bordered" cellspacing="0" width="100%">
                    <thead>
                    <tr>
                        <th> Date Livraison </th>
                        <th> Adresse de livraison </th>
                        <th> Etat </th>
                        <th> Prix Total de La commande</th>
                        <th> Nom & Prenom  Utilisateur </th>
                        <th> Action </th>
                    </tr>
                    {% for value in livraison %}
                    {% if value.idLivreur== app.user.id %}
                    <tbody>
                    <tr>
                        <td>{{ value.dateLivraison|date }}</td>
                        <td> {{ value.adresseComplete }}</td>
                        <td>
                            {{ value.etatLivraison }}
                            {% if value.etatLivraison=='En cours' %}
                            <i class="fa fa-spinner fa-2x fa-pulse " style="color: #0da899"></i>
                             {% endif %}
                        {% if value.etatLivraison=='Effectué' %}
                            <i class="fas fa-check fa-2x " style="color: #0da899"></i>
                        {% endif %}

                        </td>
                        <td>
                            {% for v2 in commandes %}
                                {% if value.idCommande == v2.id %}
                                    {{ v2.prixTotal }}
                                {%  endif %}
                            {% endfor %}
                        </td>

                        <td>
                            {% for u in users %}
                                {% if value.idUtilisateur == u.id %}
                                    {{ u.nom }} {{ u.prenom }}
                                {%  endif %}
                            {% endfor %}
                        </td>
                        <td>
                           <a href="{{ path('changer_etat',{ 'id_l': app.user.id ,'id_liv': value.id }) }}"><button>Commande livré</button></a>
                        </td>

                    </tr>
                    </tbody>
                    {% endif %}
                    {% endfor %}
                </table>
            </div>
        </div>

    {% else %}
        <h1> Vous n'avez pas de livraisons pour le moment </h1>
    {% endif %}

{% endblock %}